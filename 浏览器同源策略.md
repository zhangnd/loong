# 浏览器同源策略

## 什么是同源策略

同源策略是一种安全机制，用于web浏览器中限制不同源之间的交互。这个机制主要用于隔离潜在的有害文档，预防可能的攻击。需要注意，同源策略保护的是资源所在的源，而非请求资源的源。

### 同源定义

所谓同源是指两个源具备相同协议、域名、端口，下表给出了与 URL http[]()://store.company.com/dir/page.html 的源进行对比的示栗：

| URL | 结果	| 原因 |
| ---- | ---- | ---- |
| http[]()://store.company.com/dir2/other.html | 同源 | |
| http[]()://store.company.com/dir/inner/another.html | 同源 | |
| https[]()://store.company.com/secure.html | 不同源 | 协议不同 |
| http[]()://news.company.com/dir/other.html | 不同源 | 域名不同 |
| http[]()://store.company.com:81/dir/etc.html | 不同源 | 端口不同 |


浏览器同源策略中，除了上述的几个标签可以跨域加载外，其他出现跨域请求时，请求会发送到跨域的服务器，并且服务器会返回数据，只不过浏览器“拒收”返回的数据。

浏览器的同源策略的目的是为了保护用户的信息安全，为了防止恶意网站窃取用户在浏览器上的数据，如果不是同源的站点，将不能进行如下操作：

## 如何解决跨域问题

### JSONP

JSONP的本质是，利用script标签的src属性不受同源策略的影响，通过带有参数和回调函数的url发起一次get请求（这也是jsonp只能发起get请求的原因，因为只有get请求才能把参数和回调函数拼接到url中），服务器将接口返回的数据拼凑到回调函数中，返回给浏览器，浏览器解析执行，从而前端拿到回调函数返回的数据。

示栗：

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    function fn(data) {
      console.log(data)
    }
  </script>
  <!-- 将非同源服务端请求地址写在script标签的src属性中 -->
  <script src="https://api.map.baidu.com/geocoder/v2/?location=22.53332,C113.93041&ak=KOmVjPVUAey1G2E8zNhPiuQ6QiEmAwZu&output=json&pois=1&callback=fn"></script>
</body>
</html>
```

### CORS

### 服务器代理

同源策略是仅针对浏览器的安全策略。服务端调用http接口只是使用http协议，不需要同源策略，也就不存在跨域问题。
