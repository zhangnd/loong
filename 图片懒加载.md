# 图片懒加载

## 什么是懒加载

懒加载是一种对网页性能优化的方式，比如当访问一个网页的时候，优先显示可视区域的图片而不是一次加载全部的图片，当需要显示时，再发送请求加载图片。

## 为什么要懒加载

- 避免首次加载时消耗大量时间，降低页面渲染速度，造成卡顿现象。

- 按需加载，避免无效图片的加载，减轻服务器压力，节约网络资源。

## 懒加载原理

监听图片是否位于页面的可视区域内，若在则加载图片，不在则不加载图片。

## 实现方式

### 设置img标签loading="lazy"

```html
<img src="https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg" loading="lazy">
``` 

### 使用IntersectionObserver

```html
<div>
  <img class="lazy" data-src="https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg">
</div>
<script>
  const imgs = document.querySelectorAll('.lazy');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const target = entry.target;
        target.src = target.dataset.src;
        target.removeAttribute('data-src');
        observer.unobserve(target);
      }
    });
  });
  imgs.forEach(img => {
    observer.observe(img);
  });
</script>
```
